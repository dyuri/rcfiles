# xontribs
# - bashisms
# - xontirb-readable-traceback
# - xontrib-z - https://github.com:dyuri/xontrib-z @ zoxide
# - https://github.com/dyuri/xontrib-fzf-widgets
# - xontrib-ssh-agent
# - xontrib-pyenv
# - xontrib-repa-prompt

# start powerline daemon
powerline-daemon -q

$FOREIGN_ALIASES_SUPPRESS_SKIP_MESSAGE=True

$PROMPT_TOOLKIT_COLOR_DEPTH='DEPTH_24_BIT'
$XONSH_COLOR_STYLE='monokai'
$XONSH_SHOW_TRACEBACK=False
$COMPLETIONS_DISPLAY='single'
$HISTCONTROL='ignoredups,erasedups'

$VC_BRANCH_TIMEOUT=.2
$NPM_PACKAGES=$HOME+'/.npm'
$GOPATH="/home/dyuri/egyeb/prog/go"
$PYENV_ROOT=$HOME+"/.pyenv"
$PATH=[$HOME+'/bin', $HOME+'/.local/bin', $HOME+'/.cargo/bin'] + $PATH
$PATH=$PATH + [$PYENV_ROOT+'/bin', $PYENV_ROOT+'/shims', $PYENV_ROOT+'/plugins/pyenv-virtualenv/shims']
$PATH.append($NPM_PACKAGES+'/bin')
$PATH.append($GOPATH[0]+'/bin')
# $GO111MODULE="on"
$SDL_AUDIODRIVER="pulse"
$AUDIODEV="default"
$PYTHONSTARTUP=$HOME+"/.pythonrc"
$BROWSER="/home/dyuri/bin/ff"
# $BINARY_SSH="/bin/ssh"

# xontrib load bashisms
xontrib load direnv
xontrib load repa_prompt
xontrib load readable-traceback
xontrib load ssh_agent
xontrib load pyenv
xontrib load kitty
xontrib load gitinfo
xontrib load z

$XONSH_HISTORY_BACKEND = "sqlite"
xontrib load fzf-widgets
$fzf_history_binding = Keys.ControlR
$fzf_ssh_binding = Keys.ControlS
$fzf_file_binding = Keys.ControlT

# env
# $FZF_DEFAULT_COMMAND='rg --files --no-ignore --no-ignore-vcs --hidden --follow --glob "!.git/*" --glob "!.hg/*"'
$FZF_DEFAULT_COMMAND="fd --type file --color=always --follow --hidden --exclude .git --exclude .hg"
# $FZF_DEFAULT_OPTS="--ansi --preview-window 'right:60%' --preview 'bat --color=always --style=header,grid --line-range :100 {}'"
$FZF_DEFAULT_OPTS="--ansi --style=header,grid --line-range :100 {}'"

# dircolors
source-bash $(dircolors ~/config/dircolors/dircolors.molokai)

# kitty diff
if $TERM == 'xterm-kitty':
  aliases['d'] = ["kitty", "+kitten", "diff"]

# sudo askpass for non SSH sessions
if 'SSH_CLIENT' not in ${...}:
  aliases['sudo'] = 'sudo -A'
  $SUDO_ASKPASS = '/home/dyuri/bin/askpass-rofi'
  $SSH_ASKPASS = '/home/dyuri/bin/askpass-rofi'

# aliases
aliases['ls']=["ls", "--color=auto", "-F", "-b", "-T 0"]
aliases['ll']='exa -la --git --classify --group-directories-first'
aliases['jsonpp']='python -mjson.tool'
aliases['bible']='shuf -n 1 ~/txt/bible.txt'
aliases['vim']='nvim'
aliases['vimdiff']='nvim -d'
aliases['gtop']='glances'
aliases['lg']='lazygit'
aliases['cat']='bat'
aliases['ping']='prettyping --nolegend'
aliases['fzvim']='vim `fzf`'
aliases['py']='ipython'
aliases['mosh']=['mosh', '--ssh=repassh']

# json
try:
    import __builtin__
except ImportError:
    import builtins as __builtin__
__builtin__.true = True
__builtin__.false = False
__builtin__.null = None

# MOTD
~/bin/repamotd
